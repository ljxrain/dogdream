# 狗狗造梦家APP开发文档

## 1. 项目概述

"狗狗造梦家"是一款基于AI技术的创意内容生成应用，为用户提供照片艺术化处理、视频生成、表情包制作等功能，并支持将创意作品实体化的电商服务。本文档旨在为开发团队提供详细的开发指南和技术规范。

### 1.1 产品定位

狗狗造梦家面向普通消费者，提供简单易用的AI创意内容生成服务，让用户能够轻松将普通照片转换为艺术作品，并支持将数字作品实体化（如打印、定制商品等）。

### 1.2 核心功能

- **表情包大师**：一键制作个性化表情包
- **梦想商城**：将数字创意转化为实体产品

## 2. 技术栈

### 2.1 前端技术

- **框架**：React Native 或 Flutter (根据团队技术栈选择)
- **UI库**：遵循原型中的设计风格
- **状态管理**：Redux/MobX (React方案) 或 Provider/Bloc (Flutter方案)
- **网络请求**：Axios/Fetch API (React方案) 或 Dio (Flutter方案)
- **图片处理**：使用原生图片处理库

### 2.2 后端技术

- **服务架构**：微服务架构
- **API框架**：Node.js (Express/Nest.js) 或 Spring Boot
- **AI服务**：对接第三方AI服务或自建AI服务
- **数据库**：
  - MySQL/PostgreSQL (关系型数据库，存储用户信息、订单等)
  - MongoDB (非关系型数据库，存储作品数据)
  - Redis (缓存服务，提高响应速度)
- **对象存储**：阿里云OSS/AWS S3 (存储用户上传的图片和生成的作品)
- **消息队列**：RabbitMQ/Kafka (处理异步任务，如AI处理)

### 2.3 DevOps

- **CI/CD**：Jenkins/GitHub Actions
- **容器化**：Docker + Kubernetes
- **监控**：Prometheus + Grafana
- **日志**：ELK Stack (Elasticsearch, Logstash, Kibana)

## 3. 系统架构

### 3.1 总体架构

```
用户层 <-> 前端应用层 <-> API网关层 <-> 业务服务层 <-> 基础设施层
```

### 3.2 服务模块

1. **用户服务**：负责用户注册、登录、个人信息管理
2. **创作服务**：处理各种创意内容生成请求
3. **作品服务**：管理用户创建的作品
4. **商城服务**：处理商品展示、订单管理等
5. **支付服务**：处理支付相关流程
6. **通知服务**：推送消息和通知
7. **AI处理服务**：提供AI算法模型处理能力

## 4. 数据模型

### 4.1 核心实体

- **用户(User)**：用户基本信息、登录凭证
- **作品(Work)**：作品信息、所属用户、创建时间
- **商品(Product)**：商品信息、价格、库存
- **订单(Order)**：订单信息、支付状态、物流信息
- **地址(Address)**：用户收货地址
- **评论(Comment)**：作品或商品评论

### 4.2 关系模型

- 用户 1:N 作品
- 用户 1:N 订单
- 用户 1:N 地址
- 作品 1:N 评论
- 商品 1:N 评论
- 订单 N:M 商品

## 5. API设计

### 5.1 RESTful API规范

- 使用标准HTTP方法(GET, POST, PUT, DELETE)
- 遵循资源命名规范（复数名词）
- 使用合适的HTTP状态码
- 实现合理的错误处理机制
- 提供分页、排序、过滤功能

### 5.2 核心API示例

```
# 用户API
POST /api/users/register - 用户注册
POST /api/users/login - 用户登录
GET /api/users/me - 获取当前用户信息
PUT /api/users/me - 更新当前用户信息

# 作品API
POST /api/works - 创建新作品
GET /api/works - 获取作品列表
GET /api/works/:id - 获取作品详情
DELETE /api/works/:id - 删除作品

# 创作API
POST /api/creations/photo-to-image - 照片转艺术图片
POST /api/creations/image-to-video - 图片转视频
POST /api/creations/emoji - 生成表情包

# 商城API
GET /api/products - 获取商品列表
GET /api/products/:id - 获取商品详情
POST /api/orders - 创建订单
GET /api/orders - 获取订单列表
GET /api/orders/:id - 获取订单详情
```

## 6. 页面实现指南

### 6.1 首页(home.html)

**功能点**：
- 轮播图展示热门功能和活动
- 四大核心功能快捷入口
- 热门作品展示
- 推荐商品展示

**实现要点**：
- 轮播组件实现平滑过渡效果
- 图片懒加载优化
- 首屏加载优化
- 下拉刷新功能

### 6.2 照片圆梦(photo-to-image.html)

**功能点**：
- 照片上传/拍摄功能
- 风格模板选择
- 效果参数调整
- 生成结果预览和保存

**实现要点**：
- 照片裁剪和预处理
- 调用AI服务进行风格转换
- 处理过程中的加载状态管理
- 结果缓存和历史记录

### 6.3 圆梦视频(image-to-video.html)

**功能点**：
- 图片上传功能
- 视频效果和模板选择
- 生成视频预览
- 视频保存和分享

**实现要点**：
- 对接视频生成AI服务
- 视频加载和播放控制
- 视频处理进度展示
- 视频压缩和格式处理

### 6.4 表情包大师(emoji_master.html)

**功能点**：
- 照片上传/拍摄
- 表情风格选择
- 文本添加
- 表情包集合管理

**实现要点**：
- 图片识别和人脸检测
- 表情包模板匹配
- 文字渲染和位置调整
- 导出为微信表情包格式

### 6.5 梦想商城(shop.html)

**功能点**：
- 商品分类展示
- 商品搜索
- 商品详情
- 购物车管理

**实现要点**：
- 商品列表分页加载
- 商品筛选和排序
- 购物车状态管理
- 价格计算和优惠券处理

### 6.6 个人中心(me.html)

**功能点**：
- 用户信息展示
- 作品管理
- 订单管理
- 系统设置

**实现要点**：
- 用户信息安全存储
- 作品列表管理
- 订单状态同步
- 设置项持久化

## 7. 安全与性能

### 7.1 安全措施

- 使用HTTPS加密传输
- 实现JWT或OAuth2.0认证
- 防止XSS和CSRF攻击
- 敏感数据加密存储
- 实现请求限流和防刷机制
- 用户权限精细化控制

### 7.2 性能优化

- 实现CDN分发静态资源
- 图片优化与懒加载
- API响应缓存
- 首屏加载优化
- 长列表虚拟滚动
- 减少不必要的网络请求

## 8. 用户体验优化

- 实现骨架屏减少等待感
- 添加适当的动画过渡效果
- 优化表单验证和错误提示
- 实现渐进式加载
- 优化触摸反馈
- 提供离线功能支持

## 9. 测试规范

### 9.1 前端测试

- 单元测试: Jest/React Testing Library
- 端到端测试: Cypress/Detox
- 视觉回归测试: Percy/Storybook

### 9.2 后端测试

- 单元测试
- 集成测试
- API自动化测试
- 性能测试

## 10. 部署与上线

### 10.1 环境配置

- 开发环境
- 测试环境
- 预发布环境
- 生产环境

### 10.2 部署流程

1. 代码审核与合并
2. 自动化构建
3. 自动化测试
4. 容器化部署
5. 灰度发布
6. 监控与回滚机制

## 附录: 开发规范

### 代码规范

- 遵循编程语言最佳实践
- 使用ESLint/Prettier等工具确保代码质量
- 编写清晰的代码注释
- 遵循一致的命名规范

### Git工作流

- 主分支: master/main
- 开发分支: develop
- 功能分支: feature/*
- 修复分支: hotfix/*
- 提交前本地测试
- 代码审查后合并 